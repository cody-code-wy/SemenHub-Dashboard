
<% flash.each do |name, msg| -%>
    <%= content_tag :h2, msg, class: name %>
<% end -%>

<% if current_user.can? :admin_purchases %>
  <div>
    <h3>Administrative Controls</h3>
    <div>
      <%= form_for @purchase do |f| %>
        <%= f.hidden_field :state, value: "invoiced" %>
        <%= f.submit "Clear for payment" %>
      <% end %>
    </div>
  </div>
<% end %>

<div>
  Purchase Number: <%= @purchase.id %>
</div>
<div>
  User: <%= @purchase.user.get_name %>
</div>
<div>
  Purchase State: <%= @purchase.state %>
</div>
<div>
  <% if @purchase&.shipment&.address %>
    Destination Address
    <div>
      <%= @purchase.shipment.account_name %>
    </div>
    <div>
      <%= @purchase.shipment.location_name %>
    </div>
    <div>
      <%= @purchase.shipment.address.line1 %>
    </div>
    <div>
      <%= @purchase.shipment.address.line2 %>
    </div>
    <div>
      <%= @purchase.shipment.address.city %>, <%= @purchase.shipment.address.region %> <%= @purchase.shipment.address.postal_code %>
    </div>
    <div>
      <%= @purchase.shipment.address.country.name %>
    </div>
  <% end %>
</div>
<%= render 'invoice' %>
<div>
  <%= render @partial if @partial %>
</div>
